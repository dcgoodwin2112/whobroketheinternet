---
import { getCollection } from 'astro:content';
import BaseLayout from '../layouts/BaseLayout.astro';

const posts = (await getCollection('blog')).sort(
  (a, b) => b.data.date.valueOf() - a.data.date.valueOf()
);

function formatDate(date: Date) {
  return new Date(date).toLocaleDateString('en-US', {
    year: 'numeric',
    month: 'long',
    day: 'numeric'
  });
}
---

<BaseLayout>
  {posts.map((post) => (
    <article class="mb-16 pb-12 border-b border-neutral-200 dark:border-neutral-700 last:border-b-0">
      <h2 class="text-3xl md:text-4xl mb-4 leading-tight">
        <a href={`/blog/${post.slug}`}>
          {post.data.title}
        </a>
      </h2>
      <div class="flex items-center gap-3 mb-6 text-sm">
        <time datetime={post.data.date.toISOString()}>
          {formatDate(post.data.date)}
        </time>
        <span>•</span>
        <span>{post.data.author}</span>
      </div>
      <p class="mb-6 text-lg leading-relaxed">{post.data.excerpt}</p>
      <a href={`/blog/${post.slug}`}>
        Read more →
      </a>
    </article>
  ))}
</BaseLayout>
